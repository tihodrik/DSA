DSA

Параметры схемы цифровой подписи
	Для построения системы цифровой подписи нужно выполнить следующие шаги:
 
		1. Выбор криптографической хеш-функции H(x)
		 
		2. Выбор простого числа q, размерность которого N в битах совпадает с размерностью в битах значений хэш-функции H(x)

		3. Выбор простого числа p, такого, что (p-1) делится на q. Битовая длина p обозначается L (2^(L−1) < p < 2^L)

		4. Выбор числа g такого, что его мультипликативный порядок по модулю p равен q (g^q ≡ 1(mod p)). Для его вычисления можно воспользоваться формулой

		g = h((p−1)/q) mod p
	 
	где h — некоторое произвольное число, h ∈ (1;p−1), такое, что g ≠ 1. В большинстве случаев значение h = 2 удовлетворяет этому требованию.
	 
	Как упомянуто выше, первоочередным параметром схемы цифровой подписи является используемая криптографическая хеш-функция, необходимая для преобразования текста сообщения в число, для которого и вычисляется подпись. Важной характеристикой этой функции является битовая длина выходной последовательности, обозначаемая далее N. В первой версии стандарта DSS рекомендована функция SHA-1 и, соответственно, битовая длина подписываемого числа 160 бит. Сейчас SHA-1 уже не является достаточно безопасной. В стандарте указаны следующие возможные пары значений чисел L и N:

		1. L = 1024, N = 160
		2. L = 2048, N = 224
		3. L = 2048, N = 256
		4. L = 3072, N = 256

	В соответствии с этим стандартом рекомендованы хеш-функции семейства SHA-2.


Открытый и секретный ключи

		1. Секретный ключ представляет собой число x∈(0;q)
		2. Открытый ключ вычисляется по формуле y = g^x  mod p
	 
	Открытыми параметрами являются числа (p, q, g, y). Закрытый параметр только один — число x. При этом числа (p, q, g) могут быть общими для группы пользователей, а числа x и y являются соответственно закрытым и открытым ключами конкретного пользователя. При подписывании сообщения используются секретные числа x и k, причем число k должно выбираться случайным образом при вычислении подписи каждого следующего сообщения.
	Поскольку (p, q, g) могут быть использованы для нескольких пользователей, на практике часто делят пользователей по некоторым критериям на группы с одинаковыми (p, q, g). Поэтому эти параметры называют доменными параметрами (Domain Parameters).
	 

Подпись сообщения
	Подпись сообщения выполняется по следующему алгоритму:

		1. Выбор случайного числа k∈(0;q)
		2. Вычисление r=(g^k  mod p)  mod q
		3. Выбор другого k, если r=0
		4. Вычисление s= k^(−1)∙(H(m)+x∙r)  mod q=( k^(q−2)  mod q)∙(H(m)+x∙r)  mod q
		5. Выбор другого k, если s=0
		6. Подписью является пара (r,s)⁆ общей длины 2N

	Вычислительно сложные операции - это возведение в степень по модулю (вычисление g^k  mod p⁆), для которого существуют быстрые алгоритмы, вычисление хэша H(m)⁆, где сложность зависит от выбранного алгоритма хэширования и размера входного сообщения, и нахождение обратного элемента k^(−1)  mod q⁆ используя, например, расширенный алгоритм Евклида или малую теорему Ферма в виде k^(−1)  mod q= k^(q−2)  mod q⁆.
 
 Проверка подписи
	Проверка подписи выполняется по алгоритму:
	1 Вычисление w=s^(−1)  mod q⁆
	2 Вычисление  u_1=(H(m)∙w) mod q
	3 Вычисление  u_2=(r∙w) mod q
	4 Вычисление v=(g^(u_1 )∙y^(u_2 )  mod p)  mod q
	5 Подпись верна, если v=r
	При проверке вычислительно сложные операции это два возведения
	в степень g^(u_1 )∙y^(u_2 )⁆, вычисление хэша H(m) ⁆ и нахождение обратного
	элемента s^(−1)  mod q⁆.
